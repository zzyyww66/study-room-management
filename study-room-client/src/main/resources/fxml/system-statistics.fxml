<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.chart.*?>

<ScrollPane fitToWidth="true" xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.studyroom.client.controller.SystemStatisticsController">
    <content>
        <VBox styleClass="system-statistics" prefHeight="1500">
            <children>
                <!-- æ ‡é¢˜æ  -->
                <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="header-bar" VBox.vgrow="NEVER">
                    <children>
                        <Label styleClass="page-title" text="ç³»ç»Ÿç»Ÿè®¡">
                            <font>
                                <Font size="24.0" />
                            </font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <ComboBox fx:id="timePeriodComboBox" onAction="#handleTimePeriodChange" prefWidth="120.0" />
                        <Button fx:id="exportButton" mnemonicParsing="false" onAction="#handleExport" styleClass="secondary-button" text="å¯¼å‡ºæŠ¥å‘Š" />
                        <Button fx:id="refreshButton" mnemonicParsing="false" onAction="#handleRefresh" styleClass="refresh-button" text="åˆ·æ–°" />
                    </children>
                    <padding>
                        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                    </padding>
                </HBox>

                <!-- å…³é”®æŒ‡æ ‡å¡ç‰‡ -->
                <GridPane hgap="20.0" vgap="20.0" styleClass="metrics-grid" VBox.vgrow="NEVER">
                    <columnConstraints>
                        <ColumnConstraints hgrow="SOMETIMES" />
                        <ColumnConstraints hgrow="SOMETIMES" />
                        <ColumnConstraints hgrow="SOMETIMES" />
                        <ColumnConstraints hgrow="SOMETIMES" />
                    </columnConstraints>
                    <rowConstraints>
                        <RowConstraints vgrow="SOMETIMES" />
                        <RowConstraints vgrow="SOMETIMES" />
                    </rowConstraints>
                    <children>
                        <!-- æ€»é¢„è®¢æ•° -->
                        <VBox alignment="CENTER" spacing="10.0" styleClass="metric-card" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <children>
                                <Label styleClass="metric-icon" text="ðŸ“Š" />
                                <Label fx:id="totalReservationsLabel" styleClass="metric-number" text="0">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                                <Label styleClass="metric-label" text="æ€»é¢„è®¢æ•°" />
                                <Label fx:id="reservationsTrendLabel" styleClass="metric-trend" text="--" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                        </VBox>
                        
                        <!-- æ€»æ”¶å…¥ -->
                        <VBox alignment="CENTER" spacing="10.0" styleClass="metric-card" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <children>
                                <Label styleClass="metric-icon" text="ðŸ’°" />
                                <Label fx:id="totalRevenueLabel" styleClass="metric-number" text="Â¥0">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                                <Label styleClass="metric-label" text="æ€»æ”¶å…¥" />
                                <Label fx:id="revenueTrendLabel" styleClass="metric-trend" text="--" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                        </VBox>
                        
                        <!-- æ´»è·ƒç”¨æˆ· -->
                        <VBox alignment="CENTER" spacing="10.0" styleClass="metric-card" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <children>
                                <Label styleClass="metric-icon" text="ðŸ‘¥" />
                                <Label fx:id="activeUsersLabel" styleClass="metric-number" text="0">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                                <Label styleClass="metric-label" text="æ´»è·ƒç”¨æˆ·" />
                                <Label fx:id="usersTrendLabel" styleClass="metric-trend" text="--" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                        </VBox>
                        
                        <!-- åº§ä½åˆ©ç”¨çŽ‡ -->
                        <VBox alignment="CENTER" spacing="10.0" styleClass="metric-card" GridPane.columnIndex="3" GridPane.rowIndex="0">
                            <children>
                                <Label styleClass="metric-icon" text="ðŸ“ˆ" />
                                <Label fx:id="utilizationRateLabel" styleClass="metric-number" text="0%">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                                <Label styleClass="metric-label" text="åº§ä½åˆ©ç”¨çŽ‡" />
                                <Label fx:id="utilizationTrendLabel" styleClass="metric-trend" text="--" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                        </VBox>
                        
                        <!-- å¹³å‡ä½¿ç”¨æ—¶é•¿ -->
                        <VBox alignment="CENTER" spacing="10.0" styleClass="metric-card" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <children>
                                <Label styleClass="metric-icon" text="â±ï¸" />
                                <Label fx:id="avgDurationLabel" styleClass="metric-number" text="0h">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                                <Label styleClass="metric-label" text="å¹³å‡ä½¿ç”¨æ—¶é•¿" />
                                <Label fx:id="durationTrendLabel" styleClass="metric-trend" text="--" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                        </VBox>
                        
                        <!-- ç”¨æˆ·æ»¡æ„åº¦ -->
                        <VBox alignment="CENTER" spacing="10.0" styleClass="metric-card" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <children>
                                <Label styleClass="metric-icon" text="â­" />
                                <Label fx:id="satisfactionLabel" styleClass="metric-number" text="0.0">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                                <Label styleClass="metric-label" text="ç”¨æˆ·æ»¡æ„åº¦" />
                                <Label fx:id="satisfactionTrendLabel" styleClass="metric-trend" text="--" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                        </VBox>
                        
                        <!-- å–æ¶ˆçŽ‡ -->
                        <VBox alignment="CENTER" spacing="10.0" styleClass="metric-card" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <children>
                                <Label styleClass="metric-icon" text="âŒ" />
                                <Label fx:id="cancellationRateLabel" styleClass="metric-number" text="0%">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                                <Label styleClass="metric-label" text="é¢„è®¢å–æ¶ˆçŽ‡" />
                                <Label fx:id="cancellationTrendLabel" styleClass="metric-trend" text="--" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                        </VBox>
                        
                        <!-- æ–°ç”¨æˆ·å¢žé•¿ -->
                        <VBox alignment="CENTER" spacing="10.0" styleClass="metric-card" GridPane.columnIndex="3" GridPane.rowIndex="1">
                            <children>
                                <Label styleClass="metric-icon" text="ðŸ“Š" />
                                <Label fx:id="newUsersLabel" styleClass="metric-number" text="0">
                                    <font>
                                        <Font size="32.0" />
                                    </font>
                                </Label>
                                <Label styleClass="metric-label" text="æ–°ç”¨æˆ·" />
                                <Label fx:id="newUsersTrendLabel" styleClass="metric-trend" text="--" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                        </VBox>
                    </children>
                    <padding>
                        <Insets bottom="20.0" left="20.0" right="20.0" top="10.0" />
                    </padding>
                </GridPane>

                <!-- å›¾è¡¨åŒºåŸŸ -->
                <TabPane VBox.vgrow="ALWAYS" styleClass="charts-tab-pane" prefHeight="800">
                    <tabs>
                        <!-- é¢„è®¢è¶‹åŠ¿å›¾ -->
                        <Tab closable="false" text="é¢„è®¢è¶‹åŠ¿">
                            <content>
                                <VBox spacing="10.0" alignment="TOP_CENTER">
                                    <children>
                                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                                            <children>
                                                <Label text="é¢„è®¢è¶‹åŠ¿åˆ†æž" styleClass="chart-title" />
                                                <Region HBox.hgrow="ALWAYS" />
                                                <ComboBox fx:id="reservationChartTypeComboBox" prefWidth="120.0" />
                                            </children>
                                            <padding>
                                                <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
                                            </padding>
                                        </HBox>
                                        <LineChart fx:id="reservationTrendChart" VBox.vgrow="ALWAYS" prefHeight="350" maxHeight="400" minHeight="300">
                                            <xAxis>
                                                <CategoryAxis side="BOTTOM" />
                                            </xAxis>
                                            <yAxis>
                                                <NumberAxis side="LEFT" />
                                            </yAxis>
                                        </LineChart>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>
                        
                        <!-- æ”¶å…¥åˆ†æžå›¾ -->
                        <Tab closable="false" text="æ”¶å…¥åˆ†æž">
                            <content>
                                <VBox spacing="10.0" alignment="TOP_CENTER">
                                    <children>
                                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                                            <children>
                                                <Label text="æ”¶å…¥åˆ†æž" styleClass="chart-title" />
                                                <Region HBox.hgrow="ALWAYS" />
                                                <ComboBox fx:id="revenueChartTypeComboBox" prefWidth="120.0" />
                                            </children>
                                            <padding>
                                                <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
                                            </padding>
                                        </HBox>
                                        <BarChart fx:id="revenueChart" VBox.vgrow="ALWAYS" prefHeight="350" maxHeight="400" minHeight="300">
                                            <xAxis>
                                                <CategoryAxis side="BOTTOM" />
                                            </xAxis>
                                            <yAxis>
                                                <NumberAxis side="LEFT" />
                                            </yAxis>
                                        </BarChart>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>
                        
                        <!-- ä½¿ç”¨ç»Ÿè®¡å›¾ -->
                        <Tab closable="false" text="ä½¿ç”¨ç»Ÿè®¡">
                            <content>
                                <VBox spacing="10.0" alignment="TOP_CENTER">
                                    <children>
                                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                                            <children>
                                                <Label text="åº§ä½ä½¿ç”¨ç»Ÿè®¡" styleClass="chart-title" />
                                                <Region HBox.hgrow="ALWAYS" />
                                                <ComboBox fx:id="usageChartTypeComboBox" prefWidth="120.0" />
                                            </children>
                                            <padding>
                                                <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
                                            </padding>
                                        </HBox>
                                        <PieChart fx:id="usageChart" VBox.vgrow="ALWAYS" prefHeight="350" maxHeight="400" minHeight="300" />
                                    </children>
                                </VBox>
                            </content>
                        </Tab>
                    </tabs>
                </TabPane>

                <!-- åº•éƒ¨çŠ¶æ€æ  -->
                <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="status-bar" VBox.vgrow="NEVER">
                    <children>
                        <Label fx:id="dataRangeLabel" text="æ•°æ®èŒƒå›´: --" />
                        <Label fx:id="statusLabel" text="å°±ç»ª" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lastUpdateLabel" text="æœ€åŽæ›´æ–°: --" />
                    </children>
                    <padding>
                        <Insets bottom="15.0" left="20.0" right="20.0" top="10.0" />
                    </padding>
                </HBox>
            </children>
        </VBox>
    </content>
</ScrollPane> 