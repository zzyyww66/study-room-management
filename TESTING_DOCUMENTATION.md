# 共享自习室管理系统 - 测试文档

## 1. 黑盒测试用例 (Black-Box Test Cases)

### 1.1 功能测试

| 测试模块   | 测试子模块/功能点 | 测试用例 ID | 测试用例描述 (输入、操作步骤) | 预期输出 | 测试结果 (通过/失败) | 备注 |
| ---------- | ----------------- | ----------- | ----------------------------- | -------- | -------------------- | ---- |
| 用户管理   | 用户注册          | TC_BB_001   | ...                           | ...      |                      |      |
|            | 用户登录          | TC_BB_002   | ...                           | ...      |                      |      |
| 自习室管理 | 查看自习室列表    | TC_BB_003   | ...                           | ...      |                      |      |
|            | ...               | ...         | ...                           | ...      |                      |      |
| 预订管理   | 创建预订          | TC_BB_004   | ...                           | ...      |                      |      |
|            | 取消预订          | TC_BB_005   | ...                           | ...      |                      |      |
| ...        | ...               | ...         | ...                           | ...      |                      |      |

### 1.2 界面测试 (UI Testing)

| 测试模块/界面 | 测试点       | 测试用例 ID | 测试用例描述 (操作步骤) | 预期效果 (布局、控件、文案) | 测试结果 (通过/失败) | 备注 |
| ------------- | ------------ | ----------- | ----------------------- | --------------------------- | -------------------- | ---- |
| 登录界面      | 界面布局     | TC_UI_001   | 打开登录界面            | 布局合理，元素对齐          |                      |      |
|               | 用户名输入框 | TC_UI_002   | 输入用户名              | 正常输入                    |                      |      |
| ...           | ...          | ...         | ...                     | ...                         |                      |      |

### 1.3 兼容性测试

| 测试环境 (操作系统、浏览器/JavaFX 版本) | 测试功能模块 | 测试用例 ID | 预期行为 | 测试结果 (通过/失败) | 备注 |
| --------------------------------------- | ------------ | ----------- | -------- | -------------------- | ---- |
| Windows 10, JavaFX 17                   | 用户登录     | TC_CM_001   | 正常登录 |                      |      |
| ...                                     | ...          | ...         | ...      |                      |      |

### 1.4 易用性测试

| 测试场景           | 任务描述                 | 用户操作路径                | 易用性评估 (直观性、效率、满意度) | 改进建议 |
| ------------------ | ------------------------ | --------------------------- | --------------------------------- | -------- |
| 新用户首次预订座位 | 用户能够顺利完成座位预订 | 注册 -> 登录 -> ... -> 预订 | ...                               | ...      |
| ...                | ...                      | ...                         | ...                               | ...      |

## 2. 白盒测试用例 (White-Box Test Cases)

### 2.1 单元测试 (Unit Testing)

| 测试模块 (类名)          | 测试方法名                   | 测试用例 ID | 测试输入/条件                 | 预期输出/状态                         | 测试结果 (通过/失败) | 备注             |
| ------------------------ | ---------------------------- | ----------- | ----------------------------- | ------------------------------------- | -------------------- | ---------------- |
| `UserServiceImpl`        | `createUser()`               | TC_WB_U_001 | `UserDto` 对象 (包含有效数据) | 用户成功创建，数据库中存在该用户      |                      | 覆盖正常流程     |
|                          | `createUser()`               | TC_WB_U_002 | `UserDto` 对象 (用户名已存在) | 抛出 `UsernameAlreadyExistsException` |                      | 覆盖异常情况     |
| `ReservationServiceImpl` | `createReservation()`        | TC_WB_R_001 | 有效的预订请求，无时间冲突    | 预订成功创建                          |                      | 检查预订逻辑     |
|                          | `checkReservationConflict()` | TC_WB_R_002 | 输入存在冲突的预订时间段      | 返回 `true`                           |                      | 测试冲突检测算法 |
| ...                      | ...                          | ...         | ...                           | ...                                   |                      |                  |

### 2.2 集成测试 (Integration Testing)

| 测试模块/组件组合                    | 测试场景描述                       | 测试用例 ID | 测试输入/操作                                    | 预期结果 (数据流、交互)      | 测试结果 (通过/失败) | 备注              |
| ------------------------------------ | ---------------------------------- | ----------- | ------------------------------------------------ | ---------------------------- | -------------------- | ----------------- |
| 用户注册 -> 登录 -> 创建预订         | 用户从注册到成功预订座位的完整流程 | TC_WB_I_001 | 模拟用户注册、登录，然后选择自习室和座位进行预订 | 各步骤数据正确传递，预订成功 |                      | 跨服务/控制器调用 |
| `ReservationService` & `SeatService` | 预订时座位状态同步                 | TC_WB_I_002 | 创建一个预订                                     | 对应座位的状态更新为已预订   |                      | 模块间数据一致性  |
| ...                                  | ...                                | ...         | ...                                              | ...                          |                      |                   |

## 3. 部署图 (Deployment Diagram)

_(请在此处使用 Markdown、ASCII Art 或嵌入图片链接的方式描述部署图)_

**示例 (ASCII Art):**

```
+---------------------+     +---------------------+     +---------------------+
|     用户客户端      | --> |    应用服务器       | --> |     数据库服务器    |
| (JavaFX Application)|     | (Spring Boot App)   |     | (SQLite)            |
+---------------------+     +---------------------+     +---------------------+
       (HTTP/S)                   (JDBC)
```

**组件说明:**

- **用户客户端 (User Client):**
  - 技术: JavaFX
  - 职责: 提供用户交互界面，发送用户请求。
- **应用服务器 (Application Server):**
  - 技术: Spring Boot, Java
  - 职责: 处理业务逻辑，数据持久化，API 接口提供。
  - 运行环境: JVM
- **数据库服务器 (Database Server):**
  - 技术: SQLite (嵌入式，在此场景下可能与应用服务器在同一节点，但逻辑分离)
  - 职责: 存储和管理应用数据。

## 4. 构件图 (Component Diagram)

_(请在此处使用 Markdown、ASCII Art 或嵌入图片链接的方式描述构件图)_

**示例 (Markdown 列表):**

- **study-room-client (客户端)**
  - `client.jar` (可执行 JavaFX 应用)
    - 依赖: `javafx-controls.jar`, `javafx-fxml.jar`, `httpclient.jar`
    - 提供接口: 用户界面
- **study-room-server (服务器端)**
  - `server.jar` (可执行 Spring Boot 应用)
    - 组件:
      - `Controller` (处理 HTTP 请求)
      - `Service` (业务逻辑)
      - `Repository` (数据访问)
      - `Entity` (数据模型)
    - 依赖: `spring-boot-starter-web.jar`, `spring-boot-starter-data-jpa.jar`, `sqlite-jdbc.jar`
    - 提供接口: REST API (`/api/...`)
- **共享库/依赖 (Shared Libraries/Dependencies)**
  - `com.studyroom.common.jar` (如果存在通用 DTO 或工具类)

## 5. 调试工具、方法和过程 (Debugging Tools, Methods, and Procedures)

### 5.1 调试工具

- **IDE Debugger:** IntelliJ IDEA / Eclipse 内置的调试器。
  - 用途: 设置断点、单步执行 (Step Over, Step Into, Step Out)、查看变量值、表达式求值。
- **日志框架:** SLF4J + Logback (或 Log4j2)。
  - 用途: 记录程序运行状态、错误信息、关键业务流程信息。通过不同日志级别 (DEBUG, INFO, WARN, ERROR) 控制输出。
- **Java Flight Recorder (JFR) 和 Java Mission Control (JMC):**
  - 用途: 性能分析、问题诊断、JVM 内部事件监控。
- **VisualVM:**
  - 用途: JVM 监控、线程分析、内存分析 (堆 Dump)、CPU 采样。
- **Postman / Insomnia:**
  - 用途: 测试后端 REST API 接口，构造请求，查看响应。
- **DB Browser for SQLite:**
  - 用途: 查看和操作 SQLite 数据库，验证数据正确性。
- **浏览器开发者工具 (F12):** (如果涉及 Web 管理界面或 Hybrid 应用)
  - 用途: 网络请求监控、前端脚本调试。

### 5.2 调试方法和过程

1.  **复现问题 (Reproduce the Bug):**

    - 清晰描述问题现象和复现步骤。
    - 收集用户报告的详细信息 (操作、输入、环境)。

2.  **分析日志 (Analyze Logs):**

    - 检查应用日志 (客户端和服务端)，寻找错误堆栈 (Stack Trace) 或异常信息。
    - 根据时间戳定位问题发生的时间点。

3.  **设置断点 (Set Breakpoints):**

    - 在怀疑有问题的代码段（例如，Controller, Service, Repository 方法）设置断点。
    - 对于客户端，可以在事件处理方法、API 调用前后设置断点。

4.  **单步执行和变量检查 (Step Through and Inspect Variables):**

    - 启动调试模式，触发问题复现步骤。
    - 当程序在断点处暂停时，使用单步执行功能逐行跟踪代码。
    - 观察变量的值是否符合预期，检查对象状态。

5.  **条件断点 (Conditional Breakpoints):**

    - 当循环次数很多或特定条件才触发问题时，使用条件断点。

6.  **异常断点 (Exception Breakpoints):**

    - 设置在特定异常抛出时程序暂停，帮助定位未被捕获或处理不当的异常。

7.  **二分法定位 (Divide and Conquer):**

    - 如果问题代码范围不明确，可以通过逐步注释掉部分代码或在不同模块间增加日志来缩小问题范围。

8.  **API 调试:**

    - 使用 Postman 等工具直接调用后端 API，排除前端引起的问题。
    - 检查请求参数、Header、Body 是否正确。
    - 分析响应状态码和内容。

9.  **数据库调试:**

    - 使用 DB Browser for SQLite 查看相关表的数据，验证数据是否按预期插入、更新或删除。
    - 手动执行 SQL 查询，检查查询逻辑是否正确。

10. **性能问题调试:**

    - 使用 JFR/JMC 或 VisualVM 分析 CPU 使用率、内存分配、线程瓶颈。
    - 检查是否有慢查询或资源泄露。

11. **前端 UI 调试:** (JavaFX)

    - 使用 Scene Builder 检查 FXML 布局是否正确。
    - 在 Controller 的 `initialize` 方法或事件处理方法中打印日志或设置断点。
    - 检查 JavaFX 组件的属性绑定和事件监听器。

12. **记录和修复 (Document and Fix):**
    - 一旦找到问题原因，记录下来。
    - 编写修复代码，并进行测试验证。
    - 考虑添加新的单元测试或集成测试用例以防止问题复发。

## 6. 运行效果 (Runtime Effects/Screenshots)

_(请在此处嵌入应用的运行截图或视频链接，展示主要功能和界面)_

### 6.1 登录界面

_(截图: login_screen.png)_

### 6.2 用户主界面 (普通用户)

_(截图: user_dashboard.png)_

### 6.3 自习室预订流程

_(截图: room_selection.png)_
_(截图: seat_selection.png)_
_(截图: reservation_confirmation.png)_

### 6.4 管理员界面 - 用户管理

_(截图: admin_user_management.png)_

### 6.5 管理员界面 - 统计信息

_(截图: admin_statistics.png)_

---

**备注:** 请根据项目的实际情况填充和完善以上各个部分。
例如，在部署图和构件图中，您可以使用更专业的绘图工具（如 draw.io, PlantUML）生成图片，然后将图片链接嵌入到 Markdown 文件中。
测试用例需要根据您的具体功能点详细设计。
运行效果部分，可以逐步添加应用的实际运行截图。
